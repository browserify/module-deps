var through = require('through');

module.exports = function (file, opts) {
    var bufs = [];
    return through(write, end);
    
    function write (buf) {
        if (!Buffer.isBuffer(buf)) buf = Buffer(buf);
        bufs.push(buf);
    }
    
    function end () {
        var str = Buffer.concat(bufs).toString('utf8');
        this.queue(str.replace(/GGG/g, opts.z));
        this.queue(null);
    }
};
